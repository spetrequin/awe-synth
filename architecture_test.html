<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWE Player - Testing Suite</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            background: #0a0e1a;
            color: #e0e0e0;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 10px;
            border: 1px solid #333;
        }
        .header h1 {
            color: #00ff88;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00ff88;
        }
        .test-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .test-panel {
            background: #1a1a2e;
            border: 1px solid #333;
            border-radius: 10px;
            padding: 20px;
        }
        .test-category {
            color: #ffa500;
            font-size: 1.3em;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }
        .test-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            transition: all 0.2s ease;
        }
        .btn-basic {
            background: #007bff;
            color: white;
        }
        .btn-basic:hover {
            background: #0056b3;
        }
        .btn-intermediate {
            background: #ffc107;
            color: #212529;
        }
        .btn-intermediate:hover {
            background: #e0a800;
        }
        .btn-advanced {
            background: #dc3545;
            color: white;
        }
        .btn-advanced:hover {
            background: #c82333;
        }
        .btn-stress {
            background: #6f42c1;
            color: white;
        }
        .btn-stress:hover {
            background: #5a32a3;
        }
        .btn-run-all {
            background: #28a745;
            color: white;
            font-size: 14px;
            padding: 12px 24px;
        }
        .btn-run-all:hover {
            background: #1e7e34;
        }
        .btn-clear {
            background: #6c757d;
            color: white;
        }
        .btn-clear:hover {
            background: #545b62;
        }
        .btn-copy {
            background: #17a2b8;
            color: white;
        }
        .btn-copy:hover {
            background: #117a8b;
        }
        .status-bar {
            background: #2d2d44;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .status-item {
            display: flex;
            align-items: center;
            margin: 5px;
        }
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-dot.green { background: #28a745; box-shadow: 0 0 5px #28a745; }
        .status-dot.red { background: #dc3545; box-shadow: 0 0 5px #dc3545; }
        .status-dot.yellow { background: #ffc107; box-shadow: 0 0 5px #ffc107; }
        .status-dot.blue { background: #007bff; box-shadow: 0 0 5px #007bff; }
        .test-results {
            background: #111;
            border: 1px solid #333;
            border-radius: 5px;
            height: 300px;
            overflow-y: auto;
            padding: 10px;
            font-size: 11px;
            color: #00ff00;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
        }
        .log-output {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            height: 400px;
            overflow-y: auto;
            font-size: 12px;
            color: #58a6ff;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
        }
        .test-summary {
            background: #1a1a2e;
            border: 1px solid #00ff88;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .test-summary h3 {
            color: #00ff88;
            margin-top: 0;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #333;
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #00ff88);
            width: 0%;
            transition: width 0.3s ease;
        }
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid #333;
            border-top: 2px solid #00ff88;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .test-level {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 3px;
            margin-left: 10px;
        }
        .level-basic { background: #007bff; color: white; }
        .level-intermediate { background: #ffc107; color: #212529; }
        .level-advanced { background: #dc3545; color: white; }
        .level-stress { background: #6f42c1; color: white; }
        .nav-header {
            background: rgba(16,33,62,0.8);
            padding: 10px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
        }
        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        .nav-brand {
            font-size: 1.2em;
            font-weight: bold;
            color: #00ff88;
            text-decoration: none;
            font-family: 'Courier New', monospace;
        }
        .nav-links {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .nav-links a {
            color: #e0e0e0;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
            font-size: 12px;
            font-family: 'Courier New', monospace;
        }
        .nav-links a:hover {
            background: rgba(0,255,136,0.2);
            color: #00ff88;
        }
        .nav-links a.active {
            background: rgba(0,255,136,0.3);
            color: #00ff88;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <nav class="nav-header">
        <div class="nav-content">
            <a href="index.html" class="nav-brand">üéµ AWE Player</a>
            <div class="nav-links">
                <a href="index.html">üè† Main Interface</a>
                <a href="architecture_test.html" class="active">üß™ Testing Suite</a>
                <a href="debug_version_info.html">üîç Debug Tools</a>
                <a href="web/index.html">üñ•Ô∏è Full Web App</a>
                <a href="web/test-comprehensive-integration.html">‚öôÔ∏è Integration Tests</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <header class="header">
            <h1>üß™ AWE Player Testing Suite</h1>
            <p>Progressive Testing: Basic ‚Üí Intermediate ‚Üí Advanced ‚Üí Stress Tests</p>
            <div class="status-bar">
                <div class="status-item">
                    <div class="status-dot red" id="wasm-status"></div>
                    <span>WASM</span>
                </div>
                <div class="status-item">
                    <div class="status-dot red" id="midi-status"></div>
                    <span>MIDI</span>
                </div>
                <div class="status-item">
                    <div class="status-dot red" id="audio-status"></div>
                    <span>Audio</span>
                </div>
                <div class="status-item">
                    <div class="status-dot red" id="sf-status"></div>
                    <span>SoundFont</span>
                </div>
                <div class="status-item">
                    <span id="test-progress">Tests: 0/0</span>
                    <div class="loading-spinner" id="loading-spinner"></div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </header>

        <div class="test-controls" style="text-align: center; margin-bottom: 20px;">
            <button class="btn btn-run-all" onclick="runAllTests()">üöÄ Run All Progressive Tests</button>
            <button class="btn btn-clear" onclick="clearResults()">üßπ Clear Results</button>
            <button class="btn btn-copy" onclick="copyResults()">üìã Copy Results</button>
        </div>

        <div class="test-grid">
            <!-- Basic Tests -->
            <div class="test-panel">
                <div class="test-category">üü¢ BASIC TESTS</div>
                <div class="test-controls">
                    <button class="btn btn-basic" onclick="runBasicTests()">Run All Basic</button>
                    <button class="btn btn-basic" onclick="testWasmLoad()">WASM Load</button>
                    <button class="btn btn-basic" onclick="testVersionInfo()">Version Info</button>
                    <button class="btn btn-basic" onclick="testSystemInit()">System Init</button>
                </div>
                <div class="test-results" id="basic-results">Basic tests ready...\n</div>
            </div>

            <!-- Intermediate Tests -->
            <div class="test-panel">
                <div class="test-category">üü° INTERMEDIATE TESTS</div>
                <div class="test-controls">
                    <button class="btn btn-intermediate" onclick="runIntermediateTests()">Run All Intermediate</button>
                    <button class="btn btn-intermediate" onclick="testMidiUtils()">MIDI Utils</button>
                    <button class="btn btn-intermediate" onclick="testBufferMgmt()">Buffer Management</button>
                    <button class="btn btn-intermediate" onclick="testSequencer()">Test Sequences</button>
                </div>
                <div class="test-results" id="intermediate-results">Intermediate tests ready...\n</div>
            </div>

            <!-- Advanced Tests -->
            <div class="test-panel">
                <div class="test-category">üî¥ ADVANCED TESTS</div>
                <div class="test-controls">
                    <button class="btn btn-advanced" onclick="runAdvancedTests()">Run All Advanced</button>
                    <button class="btn btn-advanced" onclick="testAudioProcessing()">Audio Processing</button>
                    <button class="btn btn-advanced" onclick="testMidiEvents()">MIDI Events</button>
                    <button class="btn btn-advanced" onclick="testSoundFontParsing()">SoundFont Parsing</button>
                </div>
                <div class="test-results" id="advanced-results">Advanced tests ready...\n</div>
            </div>

            <!-- Stress Tests -->
            <div class="test-panel">
                <div class="test-category">üü£ STRESS TESTS</div>
                <div class="test-controls">
                    <button class="btn btn-stress" onclick="runStressTests()">Run All Stress</button>
                    <button class="btn btn-stress" onclick="testPolyphony()">32-Voice Polyphony</button>
                    <button class="btn btn-stress" onclick="testMidiFlood()">MIDI Flooding</button>
                    <button class="btn btn-stress" onclick="testMemoryPressure()">Memory Pressure</button>
                </div>
                <div class="test-results" id="stress-results">Stress tests ready...\n</div>
            </div>
        </div>

        <div class="log-output" id="main-log">AWE Player Testing Suite - Debug Log
Initializing testing environment...

</div>

        <div class="test-summary" id="test-summary" style="display: none;">
            <h3>üéØ Test Summary</h3>
            <div id="summary-content"></div>
        </div>
    </div>

    <script type="module">
        let wasmModule = null;
        let midiPlayer = null;
        let testResults = {
            basic: { passed: 0, failed: 0, total: 0 },
            intermediate: { passed: 0, failed: 0, total: 0 },
            advanced: { passed: 0, failed: 0, total: 0 },
            stress: { passed: 0, failed: 0, total: 0 }
        };
        let allTestsRunning = false;

        // Logging functions
        function logToMain(message, type = 'info') {
            const logElement = document.getElementById('main-log');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            logElement.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function logToPanel(panelId, message, level = 'basic') {
            const panel = document.getElementById(`${panelId}-results`);
            const timestamp = new Date().toLocaleTimeString();
            const levelClass = `level-${level}`;
            panel.textContent += `[${timestamp}] ${message}\n`;
            panel.scrollTop = panel.scrollHeight;
        }

        // Status management
        function updateStatus(elementId, success, message = '') {
            const element = document.getElementById(elementId);
            element.className = `status-dot ${success ? 'green' : 'red'}`;
            if (message) {
                element.parentElement.title = message;
            }
        }

        function updateProgress() {
            const totalTests = Object.values(testResults).reduce((sum, cat) => sum + cat.total, 0);
            const passedTests = Object.values(testResults).reduce((sum, cat) => sum + cat.passed, 0);
            const failedTests = Object.values(testResults).reduce((sum, cat) => sum + cat.failed, 0);
            
            document.getElementById('test-progress').textContent = 
                `Tests: ${passedTests + failedTests}/${totalTests} (${passedTests}‚úÖ ${failedTests}‚ùå)`;
            
            const progressPercent = totalTests > 0 ? ((passedTests + failedTests) / totalTests) * 100 : 0;
            document.getElementById('progress-fill').style.width = `${progressPercent}%`;
        }

        // Test execution helpers
        function runTest(testName, testFunction, category, level = 'basic') {
            return new Promise(async (resolve) => {
                try {
                    logToPanel(category, `Running: ${testName}`, level);
                    logToMain(`[${category.toUpperCase()}] Starting: ${testName}`, 'info');
                    
                    testResults[category].total++;
                    
                    const result = await testFunction();
                    if (result === false) {
                        throw new Error(`Test returned false: ${testName}`);
                    }
                    
                    testResults[category].passed++;
                    logToPanel(category, `‚úÖ PASSED: ${testName}`, level);
                    logToMain(`[${category.toUpperCase()}] ‚úÖ PASSED: ${testName}`, 'success');
                    resolve(true);
                    
                } catch (error) {
                    testResults[category].failed++;
                    logToPanel(category, `‚ùå FAILED: ${testName} - ${error.message}`, level);
                    logToMain(`[${category.toUpperCase()}] ‚ùå FAILED: ${testName} - ${error.message}`, 'error');
                    resolve(false);
                }
                updateProgress();
            });
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize WASM
        async function initializeWASM() {
            try {
                logToMain('Initializing WASM module...', 'info');
                wasmModule = await import('./pkg/awe_synth.js');
                await wasmModule.default();
                
                const initSuccess = wasmModule.init_all_systems(44100);
                if (initSuccess) {
                    updateStatus('wasm-status', true, 'WASM initialized');
                    midiPlayer = new wasmModule.MidiPlayer();
                    updateStatus('midi-status', true, 'MIDI player ready');
                    logToMain('WASM and MIDI systems initialized successfully', 'success');
                    return true;
                } else {
                    throw new Error('System initialization failed');
                }
            } catch (error) {
                logToMain(`WASM initialization failed: ${error.message}`, 'error');
                updateStatus('wasm-status', false, error.message);
                return false;
            }
        }

        // =============================================================================
        // BASIC TESTS (Level 1) - Core functionality
        // =============================================================================
        
        window.testWasmLoad = () => runTest('WASM Module Load', async () => {
            if (!wasmModule) return false;
            const versionInfo = wasmModule.get_version_info();
            return versionInfo && versionInfo.length > 10;
        }, 'basic', 'basic');

        window.testVersionInfo = () => runTest('Version Info Parsing', async () => {
            if (!wasmModule) return false;
            const versionRaw = wasmModule.get_version_info();
            const versionInfo = JSON.parse(versionRaw);
            return versionInfo.name === 'AWE Player' && versionInfo.version === '0.1.0';
        }, 'basic', 'basic');

        window.testSystemInit = () => runTest('System Initialization', async () => {
            if (!wasmModule) return false;
            return wasmModule.init_all_systems(44100) === true;
        }, 'basic', 'basic');

        window.runBasicTests = async () => {
            logToMain('üü¢ Starting BASIC test suite...', 'info');
            await testWasmLoad();
            await delay(100);
            await testVersionInfo();
            await delay(100);
            await testSystemInit();
            logToMain('üü¢ BASIC tests completed', 'success');
        };

        // =============================================================================
        // INTERMEDIATE TESTS (Level 2) - Core features
        // =============================================================================
        
        window.testMidiUtils = () => runTest('MIDI Utilities', async () => {
            if (!wasmModule) return false;
            const noteName = wasmModule.midi_note_to_name(60);
            const noteNumber = wasmModule.note_name_to_midi('C4');
            return noteName === 'C4' && noteNumber === 60;
        }, 'intermediate', 'intermediate');

        window.testBufferMgmt = () => runTest('Buffer Management', async () => {
            if (!wasmModule) return false;
            const latency = wasmModule.get_current_latency_ms_global();
            return latency > 0 && latency < 100; // Reasonable latency range
        }, 'intermediate', 'intermediate');

        window.testSequencer = () => runTest('Test Sequence Generation', async () => {
            if (!wasmModule) return false;
            const result = wasmModule.quick_c_major_test();
            logToMain(`Test Sequence result: ${result}`, 'info');
            // Check for success indicators in the JSON response
            return result && (result.includes('SUCCESS') || result.includes('success') || result.includes('"events_queued"'));
        }, 'intermediate', 'intermediate');

        window.runIntermediateTests = async () => {
            logToMain('üü° Starting INTERMEDIATE test suite...', 'info');
            await testMidiUtils();
            await delay(200);
            await testBufferMgmt();
            await delay(200);
            await testSequencer();
            logToMain('üü° INTERMEDIATE tests completed', 'success');
        };

        // =============================================================================
        // ADVANCED TESTS (Level 3) - Complex features
        // =============================================================================
        
        window.testAudioProcessing = () => runTest('Audio Buffer Processing', async () => {
            if (!wasmModule) return false;
            const buffer = wasmModule.process_audio_buffer(128);
            return buffer && buffer.length === 128;
        }, 'advanced', 'advanced');

        window.testMidiEvents = () => runTest('MIDI Event Queuing', async () => {
            if (!wasmModule) return false;
            wasmModule.queue_midi_event_global(0n, 0, 0x90, 60, 100);
            await delay(50);
            wasmModule.queue_midi_event_global(100n, 0, 0x80, 60, 0);
            return true; // If no exception, test passes
        }, 'advanced', 'advanced');

        window.testSoundFontParsing = () => runTest('SoundFont Module Test', async () => {
            if (!wasmModule) return false;
            const result = wasmModule.test_soundfont_module();
            logToMain(`SoundFont module result: ${result}`, 'info');
            // Check for success indicators in the JSON response
            return result && (result.includes('SUCCESS') || result.includes('passed') || result.includes('"test": "passed"'));
        }, 'advanced', 'advanced');

        window.runAdvancedTests = async () => {
            logToMain('üî¥ Starting ADVANCED test suite...', 'info');
            await testAudioProcessing();
            await delay(300);
            await testMidiEvents();
            await delay(300);
            await testSoundFontParsing();
            logToMain('üî¥ ADVANCED tests completed', 'success');
        };

        // =============================================================================
        // STRESS TESTS (Level 4) - Performance and edge cases
        // =============================================================================
        
        window.testPolyphony = () => runTest('32-Voice Polyphony Test', async () => {
            if (!wasmModule) return false;
            // Queue multiple simultaneous notes
            for (let i = 0; i < 32; i++) {
                wasmModule.queue_midi_event_global(BigInt(i), 0, 0x90, 60 + (i % 12), 100);
            }
            await delay(100);
            const buffer = wasmModule.process_audio_buffer(256);
            return buffer && buffer.length === 256;
        }, 'stress', 'stress');

        window.testMidiFlood = () => runTest('MIDI Event Flooding', async () => {
            if (!wasmModule) return false;
            // Flood with MIDI events
            for (let i = 0; i < 1000; i++) {
                wasmModule.queue_midi_event_global(BigInt(i), 0, 0x90, 60, 100);
            }
            // System should handle gracefully
            return true;
        }, 'stress', 'stress');

        window.testMemoryPressure = () => runTest('Memory Pressure Test', async () => {
            if (!wasmModule) return false;
            // Generate multiple large buffers
            for (let i = 0; i < 10; i++) {
                const buffer = wasmModule.process_audio_buffer(1024);
                if (!buffer || buffer.length !== 1024) return false;
            }
            return true;
        }, 'stress', 'stress');

        window.runStressTests = async () => {
            logToMain('üü£ Starting STRESS test suite...', 'info');
            await testPolyphony();
            await delay(500);
            await testMidiFlood();
            await delay(500);
            await testMemoryPressure();
            logToMain('üü£ STRESS tests completed', 'success');
        };

        // =============================================================================
        // Main test runner
        // =============================================================================
        
        window.runAllTests = async () => {
            if (allTestsRunning) return;
            allTestsRunning = true;
            
            document.getElementById('loading-spinner').style.display = 'inline-block';
            
            // Reset results
            testResults = {
                basic: { passed: 0, failed: 0, total: 0 },
                intermediate: { passed: 0, failed: 0, total: 0 },
                advanced: { passed: 0, failed: 0, total: 0 },
                stress: { passed: 0, failed: 0, total: 0 }
            };
            
            logToMain('üöÄ Starting PROGRESSIVE TEST SUITE', 'info');
            logToMain('=============================================', 'info');
            
            // Run tests progressively
            await runBasicTests();
            await delay(500);
            await runIntermediateTests();
            await delay(500);
            await runAdvancedTests();
            await delay(500);
            await runStressTests();
            
            // Show summary
            showTestSummary();
            
            document.getElementById('loading-spinner').style.display = 'none';
            allTestsRunning = false;
            
            logToMain('=============================================', 'info');
            logToMain('üéØ ALL TESTS COMPLETED', 'success');
        };

        function showTestSummary() {
            const totalTests = Object.values(testResults).reduce((sum, cat) => sum + cat.total, 0);
            const totalPassed = Object.values(testResults).reduce((sum, cat) => sum + cat.passed, 0);
            const totalFailed = Object.values(testResults).reduce((sum, cat) => sum + cat.failed, 0);
            
            const summaryElement = document.getElementById('test-summary');
            const contentElement = document.getElementById('summary-content');
            
            let summaryHTML = `
                <p><strong>Overall Results:</strong> ${totalPassed}/${totalTests} tests passed (${((totalPassed/totalTests)*100).toFixed(1)}%)</p>
                <ul>
                    <li>üü¢ Basic: ${testResults.basic.passed}/${testResults.basic.total} passed</li>
                    <li>üü° Intermediate: ${testResults.intermediate.passed}/${testResults.intermediate.total} passed</li>
                    <li>üî¥ Advanced: ${testResults.advanced.passed}/${testResults.advanced.total} passed</li>
                    <li>üü£ Stress: ${testResults.stress.passed}/${testResults.stress.total} passed</li>
                </ul>
            `;
            
            if (totalFailed === 0) {
                summaryHTML += '<p style="color: #00ff88;">üéâ ALL TESTS PASSED! AWE Player is fully operational.</p>';
            } else {
                summaryHTML += `<p style="color: #ffa500;">‚ö†Ô∏è ${totalFailed} test(s) failed. Check logs for details.</p>`;
            }
            
            contentElement.innerHTML = summaryHTML;
            summaryElement.style.display = 'block';
        }

        // Utility functions
        window.clearResults = () => {
            document.getElementById('basic-results').textContent = 'Basic tests ready...\n';
            document.getElementById('intermediate-results').textContent = 'Intermediate tests ready...\n';
            document.getElementById('advanced-results').textContent = 'Advanced tests ready...\n';
            document.getElementById('stress-results').textContent = 'Stress tests ready...\n';
            document.getElementById('main-log').textContent = 'AWE Player Testing Suite - Debug Log\nCleared and ready for new tests...\n\n';
            document.getElementById('test-summary').style.display = 'none';
            
            testResults = {
                basic: { passed: 0, failed: 0, total: 0 },
                intermediate: { passed: 0, failed: 0, total: 0 },
                advanced: { passed: 0, failed: 0, total: 0 },
                stress: { passed: 0, failed: 0, total: 0 }
            };
            updateProgress();
        };

        window.copyResults = async () => {
            const mainLog = document.getElementById('main-log').textContent;
            const basicResults = document.getElementById('basic-results').textContent;
            const intermediateResults = document.getElementById('intermediate-results').textContent;
            const advancedResults = document.getElementById('advanced-results').textContent;
            const stressResults = document.getElementById('stress-results').textContent;
            
            const fullResults = `AWE Player Testing Suite Results
==================================================

MAIN LOG:
${mainLog}

BASIC TESTS:
${basicResults}

INTERMEDIATE TESTS:
${intermediateResults}

ADVANCED TESTS:
${advancedResults}

STRESS TESTS:
${stressResults}
==================================================`;
            
            try {
                await navigator.clipboard.writeText(fullResults);
                logToMain('Test results copied to clipboard', 'success');
            } catch (err) {
                logToMain('Failed to copy results to clipboard', 'error');
            }
        };

        // Initialize on page load
        initializeWASM();
    </script>
</body>
</html>